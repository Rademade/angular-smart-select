(function(){angular.module("ngSmartSelect",["ngSanitize"]).directive("selector",["ObjectItemsPreparer","ArrayItemsPreparer","$document",function(e,t,r){var s;return s=13,{require:"?ngModel",restrict:"E",templateUrl:"selector.html",scope:{values:"=?",modelValue:"@",maxItems:"@",matchClass:"@",adding:"@",placeholder:"@",label:"@",emptyResultMessage:"@",ngDisabled:"=?",settings:"=?",form:"=?",autoLoader:"=?"},link:function(r,n,o,a){var l,i,c,u;return l=n.find("input")[0],r.clearSelector=function(e){return r.focus=!1,c()},i=function(e){return r.autoLoader?r.autoLoader(e).then(function(e){return r.values=e}):void 0},a.$render=function(){return r.model=a.$modelValue},r.$watch("model",function(){return r.values?(r.selectedItem="",u()):void 0}),r.keyPressed=function(e){return e.keyCode!==s?!1:c()},r.handleArrowClick=function(e){return r.handleClick(e)},r.handleClick=function(e,t){return r.selectedItem="",l.focus()},r.addNewItem=function(){var e;if(!(r.settings&&r.selectedItem.length<r.settings.minStringLength||r.itemsPreparer.checkItemExists(r.selectedItem)))return e={},r.modelValue?e[r.modelValue]=r.selectedItem:e=r.selectedItem,r.model=e,a.$setViewValue(r.model),r.values.push(e)},r.$watch("selectedItem",function(){return i(r.selectedItem),r.itemsPreparer?r.itemsPreparer.setMatch(r.selectedItem):void 0}),r.onFocus=function(){return r.focus=!0,r.itemsPreparer&&r.itemsPreparer.setMatch(r.selectedItem),r.selectedItem=""},r.setItem=function(e){var t;return t=!0,r.modelValue?(t=r.selectedItem===r.values[e.index][r.modelValue],r.selectedItem=r.values[e.index][r.modelValue]):(t=r.selectedItem===r.values[e.index],r.selectedItem=r.values[e.index]),r.model=r.values[e.index],t||a.$setViewValue(r.model),r.itemsPreparer.setMatch(r.selectedItem),r.focus=!1},u=function(){return r.properItems=[],r.modelValue?(r.model&&(r.selectedItem=r.model[r.modelValue]),r.itemsPreparer=new e(r.values,r.matchClass,r.properItems,r.modelValue)):(r.model&&(r.selectedItem=r.model),r.itemsPreparer=new t(r.values,r.matchClass,r.properItems)),r.itemsPreparer.setMatch(r.selectedItem)},r.$watch("values",function(){return r.values?r.itemsPreparer?(r.itemsPreparer.resetValues(r.values),r.itemsPreparer.setMatch(r.selectedItem)):u():void 0}),c=function(){return r.modelValue&&r.model?r.selectedItem=r.model[r.modelValue]:r.selectedItem=r.model,r.properItems&&r.properItems[0]&&1===r.properItems.length?r.setItem(r.properItems[0]):void 0}}}}])}).call(this),function(){var e=function(e,r){function s(){this.constructor=e}for(var n in r)t.call(r,n)&&(e[n]=r[n]);return s.prototype=r.prototype,e.prototype=new s,e.__super__=r.prototype,e},t={}.hasOwnProperty;angular.module("ngSmartSelect").factory("ArrayItemsPreparer",["ItemsPreparer",function(t){var r;return r=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return e(r,t),r.prototype.prepare=function(){var e,t,r,s,n,o;if(this.values){for(this.updateItems(),s=this.values,n=[],t=e=0,r=s.length;r>e;t=++e)o=s[t],this.isMatch(o,this.match)?n.push(this.properItems.push(this.createItem(o,t))):n.push(void 0);return n}},r}(t)}])}.call(this),function(){angular.module("ngSmartSelect").service("highlighter",[function(){return{get:function(e,t,r){return(""+e).replaceAll(""+t,""+r)}}}])}.call(this),function(){angular.module("ngSmartSelect").factory("ItemsPreparer",["highlighter",function(e){var t;return t=function(){function t(e,t,r){this.values=e,this.matchClass=t,this.properItems=r}return t.prototype.values=[],t.prototype.items=[],t.prototype.properItems=[],t.prototype.match="",t.prototype.matchClass="",t.prototype.matchedField="name",t.prototype.setMatch=function(e){return this.match=e,this.prepare()},t.prototype.createItem=function(t,r){var s;return s={},s.index=r,s[this.matchedField]=e.get(t,this.match,this.matchClass),s},t.prototype.addValue=function(e){return this.values.push(e)},t.prototype.resetValues=function(e){return this.values=e},t.prototype.prepare=function(){throw new OverrideException("prepare","ItemsPreparer")},t.prototype.updateItems=function(){var e;for(e=[];this.properItems.length>0;)e.push(this.properItems.pop());return e},t.prototype.getProperItems=function(){return this.properItems},t.prototype.checkItemExists=function(e){var t,r,s,n,o;for(o=this.items,r=t=0,n=o.length;n>t;r=++t)if(s=o[r],s[this.matchedField]===e)return!0;return!1},t.prototype.isMatch=function(e,t){return(""+e).toLowerCase().indexOf((""+t).toLowerCase())>-1},t}()}])}.call(this),function(){var e=function(e,r){function s(){this.constructor=e}for(var n in r)t.call(r,n)&&(e[n]=r[n]);return s.prototype=r.prototype,e.prototype=new s,e.__super__=r.prototype,e},t={}.hasOwnProperty;angular.module("ngSmartSelect").factory("ObjectItemsPreparer",["ItemsPreparer",function(t){var r;return r=function(t){function r(e,t,s,n){r.__super__.constructor.call(this,e,t,s),this.matchedField=n}return e(r,t),r.prototype.prepare=function(){var e,t,r,s,n,o;if(this.values){for(this.updateItems(),s=this.values,n=[],t=e=0,r=s.length;r>e;t=++e)o=s[t],this.isMatch(o[this.matchedField],this.match)||""===this.matchedField?n.push(this.properItems.push(this.createItem(o[this.matchedField],t))):n.push(void 0);return n}},r}(t)}])}.call(this),function(){angular.module("ngSmartSelect").directive("smartSelectorBodyClick",["$document","$timeout",function(e,t){return{scope:{smartSelectorBodyClick:"&",isActive:"=?"},link:function(r,s,n){var o;return o=function(e){return r.isActive?s[0].contains(e.currentTarget.activeElement)?void 0:t(function(){return r.smartSelectorBodyClick()},0):void 0},e.bind("click",o),r.$on("$destroy",function(){return e.unbind("click",o)})}}}])}.call(this),function(){String.prototype.replaceAll=function(e,t,r){return e=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),this.replace(new RegExp("([^("+e+")]*)("+e+")([^("+e+")]*)","gi"),'$1<span class="'+t+'">$2</span>$3')}}.call(this),function(){this.OverrideException=function(){function e(e,t){this.message="abstract method "+e+" on "+t+" not overridden"}return e.prototype.name="overrideException",e.prototype.messages="",e}()}.call(this),angular.module("ngSmartSelect").run(["$templateCache",function(e){e.put("selector.html",'<label ng-init="focus=false" ng-class="{ \'is-current\': focus }" class="selector-wrapper"><input ng-click="handleClick($event)" smart-selector-body-click="clearSelector()" is-active="focus" ng-class="{ \'is-disabled\' : ngDisabled }" ng-keypress="keyPressed($event)" ng-disabled="ngDisabled" ng-model="selectedItem" type="text" ng-focus="onFocus()" placeholder="{{placeholder}}" class="input-selector"/><i ng-click="handleArrowClick($event)" class="selector-arrow"></i><span class="input-hint">{{label}}</span><div ng-class="{\'empty\': !focus}" class="select-list"><div ng-if="properItems.length &gt; 0" class="select-list-box"><div ng-show="properItems &amp;&amp; focus " ng-repeat="properItem in properItems" ng-click="setItem(properItem);$event.stopImmediatePropagation();$event.preventDefault();" class="select-item"><span ng-bind-html="properItem[modelValue] || properItem[\'name\']" class="select-item-text"></span></div></div><span ng-if="properItems.length == 0 &amp;&amp; focus" class="empty-result">{{emptyResultMessage}}</span><div ng-show="focus &amp;&amp; adding" class="select-btn-box"><button ng-click="addNewItem()" class="select-btn">{{adding}}</button></div></div></label>')}]);