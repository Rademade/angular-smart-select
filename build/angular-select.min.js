(function(){angular.module("ngSmartSelect",["ngSanitize"]).directive("selector",["ObjectItemsPreparer","ArrayItemsPreparer",function(e,t){var r;return r=13,{require:"?ngModel",restrict:"E",templateUrl:"selector.html",scope:{values:"=",modelValue:"@",maxItems:"@",matchClass:"@",adding:"@",placeholder:"@",label:"@",emptyResultMessage:"@",ngDisabled:"=?",settings:"=?",form:"=?"},link:function(s,n,o,a){var l,c,i,p;return l=function(){return s.focus=!1,i()},c=angular.element(document.getElementsByTagName("body")[0]),c.bind("click",l),a.$render=function(){return s.model=a.$modelValue},s.$on("$destroy",function(){return c.unbind("click",l)}),s.$watch("model",function(){return s.values?(s.selectedItem="",p()):void 0}),s.keyPressed=function(e){return e.keyCode!==r?!1:i()},s.handleClick=function(e){return n.find("input")[0].focus(),e.stopPropagation(),e.preventDefault()},s.addNewItem=function(){var e;if(!(s.settings&&s.selectedItem.length<s.settings.minStringLength||s.ItemsPreparer.checkItemExists(s.selectedItem)))return e={},s.modelValue?e[s.modelValue]=s.selectedItem:e=s.selectedItem,s.model=e,a.$setViewValue(s.model),s.values.push(e)},s.$watch("selectedItem",function(){return s.ItemsPreparer?s.ItemsPreparer.setMatch(s.selectedItem):void 0}),s.onFocus=function(){return n[0].click(),s.focus=!0,s.ItemsPreparer&&s.ItemsPreparer.setMatch(s.selectedItem),s.selectedItem=""},s.setItem=function(e){var t;return t=!0,s.modelValue?(t=s.selectedItem===s.values[e.index][s.modelValue],s.selectedItem=s.values[e.index][s.modelValue]):(t=s.selectedItem===s.values[e.index],s.selectedItem=s.values[e.index]),s.model=s.values[e.index],t||a.$setViewValue(s.model),s.ItemsPreparer.setMatch(s.selectedItem),s.focus=!1},p=function(){return s.properItems=[],s.modelValue?(s.model&&(s.selectedItem=s.model[s.modelValue]),s.ItemsPreparer=new e(s.values,s.matchClass,s.properItems,s.modelValue)):(s.model&&(s.selectedItem=s.model),s.ItemsPreparer=new t(s.values,s.matchClass,s.properItems)),s.ItemsPreparer.setMatch(s.selectedItem)},s.$watch("values",function(){return s.values?p():void 0}),i=function(){return s.modelValue&&s.model?s.selectedItem=s.model[s.modelValue]:s.selectedItem=s.model,s.properItems[0]&&1===s.properItems.length?s.setItem(s.properItems[0]):void 0}}}}])}).call(this),function(){var e=function(e,r){function s(){this.constructor=e}for(var n in r)t.call(r,n)&&(e[n]=r[n]);return s.prototype=r.prototype,e.prototype=new s,e.__super__=r.prototype,e},t={}.hasOwnProperty;angular.module("ngSmartSelect").factory("ArrayItemsPreparer",["ItemsPreparer",function(t){var r;return r=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return e(r,t),r.prototype.prepare=function(){var e,t,r,s,n,o;for(this.updateItems(),s=this.values,n=[],t=e=0,r=s.length;r>e;t=++e)o=s[t],this.isMatch(o,this.match)?n.push(this.properItems.push(this.createItem(o,t))):n.push(void 0);return n},r}(t)}])}.call(this),function(){angular.module("ngSmartSelect").service("Highlighter",[function(){return{get:function(e,t,r){return(""+e).replaceAll(""+t,""+r)}}}])}.call(this),function(){angular.module("ngSmartSelect").factory("ItemsPreparer",["Highlighter",function(e){var t;return t=function(){function t(e,t,r){this.values=e,this.matchClass=t,this.properItems=r}return t.prototype.values=[],t.prototype.items=[],t.prototype.properItems=[],t.prototype.match="",t.prototype.matchClass="",t.prototype.matchedField="name",t.prototype.setMatch=function(e){return this.match=e,this.prepare()},t.prototype.createItem=function(t,r){var s;return s={},s.index=r,s[this.matchedField]=e.get(t,this.match,this.matchClass),s},t.prototype.addValue=function(e){return this.values.push(e)},t.prototype.prepare=function(){throw new OverrideException("prepare","ItemsPreparer")},t.prototype.updateItems=function(){var e;for(e=[];this.properItems.length>0;)e.push(this.properItems.pop());return e},t.prototype.getProperItems=function(){return this.properItems},t.prototype.checkItemExists=function(e){var t,r,s,n,o;for(o=this.items,r=t=0,n=o.length;n>t;r=++t)if(s=o[r],s[this.matchedField]===e)return!0;return!1},t.prototype.isMatch=function(e,t){return(""+e).toLowerCase().indexOf((""+t).toLowerCase())>-1},t}()}])}.call(this),function(){var e=function(e,r){function s(){this.constructor=e}for(var n in r)t.call(r,n)&&(e[n]=r[n]);return s.prototype=r.prototype,e.prototype=new s,e.__super__=r.prototype,e},t={}.hasOwnProperty;angular.module("ngSmartSelect").factory("ObjectItemsPreparer",["ItemsPreparer",function(t){var r;return r=function(t){function r(e,t,s,n){r.__super__.constructor.call(this,e,t,s),this.matchedField=n}return e(r,t),r.prototype.prepare=function(){var e,t,r,s,n,o;for(this.updateItems(),s=this.values,n=[],t=e=0,r=s.length;r>e;t=++e)o=s[t],this.isMatch(o[this.matchedField],this.match)||""===this.matchedField?n.push(this.properItems.push(this.createItem(o[this.matchedField],t))):n.push(void 0);return n},r}(t)}])}.call(this),function(){String.prototype.replaceAll=function(e,t,r){return e=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),this.replace(new RegExp("([^("+e+")]*)("+e+")([^("+e+")]*)","gi"),'$1<span class="'+t+'">$2</span>$3')}}.call(this),function(){this.OverrideException=function(){function e(e,t){this.message="abstract method "+e+" on "+t+" not overridden"}return e.prototype.name="overrideException",e.prototype.messages="",e}()}.call(this),angular.module("ngSmartSelect").run(["$templateCache",function(e){e.put("selector.html",'<label ng-init="focus=false" ng-class="{ \'is-current\': focus }" class="selector-wrapper"><input ng-click="handleClick($event)" ng-class="{ \'is-disabled\' : ngDisabled }" ng-keypress="keyPressed($event)" ng-disabled="ngDisabled" ng-model="selectedItem" type="text" ng-focus="onFocus()" placeholder="{{placeholder}}" class="input-selector"/><i ng-click="handleClick($event)" class="selector-arrow"></i><span class="input-hint">{{label}}</span><div ng-class="{\'empty\': !focus}" class="select-list"><div ng-if="properItems.length &gt; 0" class="select-list-box"><div ng-show="properItems &amp;&amp; focus " ng-repeat="properItem in properItems" ng-click="setItem(properItem);$event.stopImmediatePropagation();$event.preventDefault();" class="select-item"><span ng-bind-html="properItem[modelValue] || properItem[\'name\']" class="select-item-text"></span></div></div><span ng-if="properItems.length == 0 &amp;&amp; focus" class="empty-result">{{emptyResultMessage}}</span><div ng-show="focus &amp;&amp; adding" class="select-btn-box"><button ng-click="addNewItem()" class="select-btn">{{adding}}</button></div></div></label>')}]);