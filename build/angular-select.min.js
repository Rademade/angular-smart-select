(function(){angular.module("ngSmartSelect",["ngSanitize"]).directive("selector",["ObjectItemsPreparer","ArrayItemsPreparer",function(e,t){var r;return r=13,{require:"?ngModel",restrict:"E",templateUrl:"selector.html",scope:{values:"=",modelValue:"@",maxItems:"@",matchClass:"@",adding:"@",placeholder:"@",label:"@",emptyResultMessage:"@",ngDisabled:"=?"},link:function(n,s,o,a){var l,c,i,p;return l=function(){return n.focus=!1,i()},c=angular.element(document.getElementsByTagName("body")[0]),c.bind("click",l),a.$render=function(){return n.model=a.$modelValue},n.$on("$destroy",function(){return c.unbind("click",l)}),n.$watch("model",function(){return n.values?p():void 0}),n.keyPressed=function(e){return e.keyCode!==r?!1:i()},n.handleClick=function(e){return s.find("input")[0].focus(),e.stopPropagation(),e.preventDefault()},n.addNewItem=function(){var e;if(!n.ItemsPreparer.checkItemExists(n.selectedItem))return e={},n.modelValue?e[n.modelValue]=n.selectedItem:e=n.selectedItem,n.model=e,a.$setViewValue(n.model),n.values.push(e)},n.$watch("selectedItem",function(){return n.ItemsPreparer?n.ItemsPreparer.setMatch(n.selectedItem):void 0}),n.onFocus=function(){return s[0].click(),n.focus=!0,n.ItemsPreparer&&n.ItemsPreparer.setMatch(n.selectedItem),n.selectedItem=""},n.setItem=function(e){return n.selectedItem=n.modelValue?n.values[e.index][n.modelValue]:n.values[e.index],n.model=n.values[e.index],a.$setViewValue(n.model),n.ItemsPreparer.setMatch(n.selectedItem),n.focus=!1},p=function(){return n.properItems=[],n.modelValue?(n.model&&(n.selectedItem=n.model[n.modelValue]),n.ItemsPreparer=new e(n.values,n.matchClass,n.properItems,n.modelValue)):(n.model&&(n.selectedItem=n.model),n.ItemsPreparer=new t(n.values,n.matchClass,n.properItems)),n.ItemsPreparer.setMatch(n.selectedItem)},n.$watch("values",function(){return n.values?p():void 0}),i=function(){return n.selectedItem=n.modelValue&&n.model?n.model[n.modelValue]:n.model,n.properItems[0]&&1===n.properItems.length?n.setItem(n.properItems[0]):void 0}}}}])}).call(this),function(){var e=function(e,r){function n(){this.constructor=e}for(var s in r)t.call(r,s)&&(e[s]=r[s]);return n.prototype=r.prototype,e.prototype=new n,e.__super__=r.prototype,e},t={}.hasOwnProperty;angular.module("ngSmartSelect").factory("ArrayItemsPreparer",["ItemsPreparer",function(t){var r;return r=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return e(r,t),r.prototype.prepare=function(){var e,t,r,n,s,o;for(this.updateItems(),n=this.values,s=[],t=e=0,r=n.length;r>e;t=++e)o=n[t],s.push(this.isMatch(o,this.match)?this.properItems.push(this.createItem(o,t)):void 0);return s},r}(t)}])}.call(this),function(){angular.module("ngSmartSelect").service("Highlighter",[function(){return{get:function(e,t,r){return(""+e).replaceAll(""+t,"<span class='"+r+"'>"+t+"</span>")}}}])}.call(this),function(){angular.module("ngSmartSelect").factory("ItemsPreparer",["Highlighter",function(e){var t;return t=function(){function t(e,t,r){this.values=e,this.matchClass=t,this.properItems=r}return t.prototype.values=[],t.prototype.items=[],t.prototype.properItems=[],t.prototype.match="",t.prototype.matchClass="",t.prototype.matchedField="name",t.prototype.setMatch=function(e){return this.match=e,this.prepare()},t.prototype.createItem=function(t,r){var n;return n={},n.index=r,n[this.matchedField]=e.get(t,this.match,this.matchClass),n},t.prototype.addValue=function(e){return this.values.push(e)},t.prototype.prepare=function(){throw new OverrideException("prepare","ItemsPreparer")},t.prototype.updateItems=function(){var e;for(e=[];this.properItems.length>0;)e.push(this.properItems.pop());return e},t.prototype.getProperItems=function(){return this.properItems},t.prototype.checkItemExists=function(e){var t,r,n,s,o;for(o=this.items,r=t=0,s=o.length;s>t;r=++t)if(n=o[r],n[this.matchedField]===e)return!0;return!1},t.prototype.isMatch=function(e,t){return(""+e).toLowerCase().indexOf((""+t).toLowerCase())>-1},t}()}])}.call(this),function(){var e=function(e,r){function n(){this.constructor=e}for(var s in r)t.call(r,s)&&(e[s]=r[s]);return n.prototype=r.prototype,e.prototype=new n,e.__super__=r.prototype,e},t={}.hasOwnProperty;angular.module("ngSmartSelect").factory("ObjectItemsPreparer",["ItemsPreparer",function(t){var r;return r=function(t){function r(e,t,n,s){r.__super__.constructor.call(this,e,t,n),this.matchedField=s}return e(r,t),r.prototype.prepare=function(){var e,t,r,n,s,o;for(this.updateItems(),n=this.values,s=[],t=e=0,r=n.length;r>e;t=++e)o=n[t],s.push(this.isMatch(o[this.matchedField],this.match)||""===this.matchedField?this.properItems.push(this.createItem(o[this.matchedField],t)):void 0);return s},r}(t)}])}.call(this),function(){String.prototype.replaceAll=function(e,t,r){return this.replace(new RegExp(e.replace(/([\/\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g,"\\$&"),r?"gi":"g"),"string"==typeof t?t.replace(/\$/g,"$$$$"):t)}}.call(this),function(){this.OverrideException=function(){function e(e,t){this.message="abstract method "+e+" on "+t+" not overridden"}return e.prototype.name="overrideException",e.prototype.messages="",e}()}.call(this),angular.module("ngSmartSelect").run(["$templateCache",function(e){e.put("selector.html",'<label ng-init="focus=false" ng-class="{ \'is-current\': focus, \'is-disabled\': ngDisabled }" class="selector-wrapper"><input ng-click="handleClick($event)" ng-keypress="keyPressed($event)" ng-disabled="ngDisabled" ng-model="selectedItem" type="text" ng-focus="onFocus()" placeholder="{{placeholder}}" class="input-selector"/><i ng-click="handleClick($event)" class="selector-arrow"></i><span class="input-hint">{{label}}</span><span ng-if="properItems.length == 0 &amp;&amp; focus" class="empty-result">{{emptyResultMessage}}</span><div ng-class="{\'empty\': !focus}" class="select-list"><div ng-if="properItems.length &gt; 0" class="select-list-box"><div ng-show="properItems &amp;&amp; focus " ng-repeat="properItem in properItems" ng-click="setItem(properItem);$event.stopImmediatePropagation();$event.preventDefault();" class="select-item"><span ng-bind-html="properItem[modelValue] || properItem[\'name\']" class="select-item-text"></span></div></div><div ng-show="focus &amp;&amp; adding" class="select-btn-box"><button ng-click="addNewItem()" class="select-btn">{{adding}}</button></div></div></label>')}]);