(function(){angular.module("ngSmartSelect",["ngSanitize"]).directive("selector",["ObjectItemsPreparer","ArrayItemsPreparer",function(e,t){return{restrict:"E",templateUrl:"selector.html",scope:{values:"=",model:"=",modelValue:"@",maxItems:"@",matchClass:"@",adding:"@",modelChanged:"="},link:function(r,n){var o,s,a;return document.getElementsByTagName("body")[0].addEventListener("click",function(){return r.focus=!1,s()}),r.$watch("model",function(){return r.modelChanged?r.modelChanged():void 0}),r.addNewItem=function(){var e;if(!o(r.selectedItem,r.values,r.modelValue))return e={},r.modelValue?e[r.modelValue]=r.selectedItem:e=r.selectedItem,r.model=e,r.values.push(e)},r.$watch("selectedItem",function(){return r.ItemsPreparer?r.ItemsPreparer.setMatch(r.selectedItem):void 0}),r.onFocus=function(){return n[0].click(),r.focus=!0,r.ItemsPreparer&&r.ItemsPreparer.setMatch(r.selectedItem),r.selectedItem=""},r.setItem=function(e){return r.selectedItem=r.modelValue?r.values[e.index][r.modelValue]:r.values[e.index],r.model=r.values[e.index],r.ItemsPreparer.setMatch(r.selectedItem),r.focus=!1},a=function(){return r.properItems=[],r.modelValue?(r.selectedItem=r.model[r.modelValue],r.ItemsPreparer=new e(r.values,r.matchClass,r.properItems,r.modelValue)):(r.selectedItem=r.model,r.ItemsPreparer=new t(r.values,r.matchClass,r.properItems)),r.ItemsPreparer.setMatch(r.selectedItem)},r.$watch("values",function(){return r.values?(r.model||(r.model=r.values[0]),a()):void 0}),o=function(e,t,r){var n,o,s,a;for(o=n=0,a=t.length;a>n;o=++n)if(s=t[o],s[r]===e)return!0;return!1},s=function(){return r.selectedItem=r.modelValue&&r.model?r.model[r.modelValue]:r.model}}}}])}).call(this),function(){var e=function(e,r){function n(){this.constructor=e}for(var o in r)t.call(r,o)&&(e[o]=r[o]);return n.prototype=r.prototype,e.prototype=new n,e.__super__=r.prototype,e},t={}.hasOwnProperty;angular.module("ngSmartSelect").factory("ArrayItemsPreparer",["ItemsPreparer",function(t){var r;return r=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return e(r,t),r.prototype.prepare=function(){var e,t,r,n,o,s;for(this.updateItems(),n=this.values,o=[],t=e=0,r=n.length;r>e;t=++e)s=n[t],o.push((""+s).indexOf(this.match)>-1?this.properItems.push(this.createItem(s,t)):void 0);return o},r}(t)}])}.call(this),function(){angular.module("ngSmartSelect").service("Highlighter",function(){return{get:function(e,t,r){return(""+e).replaceAll(""+t,"<span class='"+r+"'>"+t+"</span>")}}})}.call(this),function(){angular.module("ngSmartSelect").factory("ItemsPreparer",["Highlighter",function(e){var t;return t=function(){function t(e,t,r){this.values=e,this.matchClass=t,this.properItems=r}return t.prototype.values=[],t.prototype.items=[],t.prototype.properItems=[],t.prototype.match="",t.prototype.matchClass="",t.prototype.matchedField="name",t.prototype.setMatch=function(e){return this.match=e,this.prepare()},t.prototype.createItem=function(t,r){var n;return n={},n.index=r,n[this.matchedField]=e.get(t,this.match,this.matchClass),n},t.prototype.addValue=function(e){return this.values.push(e)},t.prototype.prepare=function(){throw new OverrideException("prepare","ItemsPreparer")},t.prototype.updateItems=function(){var e;for(e=[];this.properItems.length>0;)e.push(this.properItems.pop());return e},t.prototype.getProperItems=function(){return this.properItems},t}()}])}.call(this),function(){var e=function(e,r){function n(){this.constructor=e}for(var o in r)t.call(r,o)&&(e[o]=r[o]);return n.prototype=r.prototype,e.prototype=new n,e.__super__=r.prototype,e},t={}.hasOwnProperty;angular.module("ngSmartSelect").factory("ObjectItemsPreparer",["ItemsPreparer",function(t){var r;return r=function(t){function r(e,t,n,o){r.__super__.constructor.call(this,e,t,n),this.matchedField=o}return e(r,t),r.prototype.prepare=function(){var e,t,r,n,o,s;for(this.updateItems(),n=this.values,o=[],t=e=0,r=n.length;r>e;t=++e)s=n[t],o.push((""+s[this.matchedField]).indexOf(this.match)>-1||""===this.matchedField?this.properItems.push(this.createItem(s[this.matchedField],t)):void 0);return o},r}(t)}])}.call(this),function(){String.prototype.replaceAll=function(e,t,r){return this.replace(new RegExp((""+e).replace(/([\/\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g,"\\$&"),r?"gi":"g"),"string"==typeof(""+t)?(""+t).replace(/\$/g,"$$$$"):""+t)}}.call(this),function(){this.OverrideException=function(){function e(e,t){this.message="abstract method "+e+" on "+t+" not overridden"}return e.prototype.name="overrideException",e.prototype.messages="",e}()}.call(this),angular.module("ngSmartSelect").run(["$templateCache",function(e){e.put("selector.html",'<div ng-init="focus=false" class="selector-wrapper"><input ng-click="$event.stopPropagation();$event.preventDefault();" ng-model="selectedItem" type="text" ng-focus="onFocus()" class="input-selector"/><div ng-class="{\'empty\': !focus}" class="select-list"><div class="select-list-box"><div ng-show="properItems &amp;&amp; focus " ng-repeat="properItem in properItems" ng-click="setItem(properItem);$event.stopImmediatePropagation();$event.preventDefault();" class="select-item"><span ng-bind-html="properItem[modelValue] || properItem[\'name\']" class="select-item-text"></span></div></div><div ng-show="focus &amp;&amp; adding" class="select-btn-box"><button ng-click="addNewItem()">Add</button></div></div></div>')}]);